services:
  drupal-cms:
    image: ghcr.io/quantcdn-templates/app-drupal-cms:latest
    build: .
    ports:
      - "8084:80"
    volumes:
      # Entire Drupal CMS codebase is persistent to support UI-based updates,
      # Project Browser, Automatic Updates, and Recipes
      - drupal_cms:/opt/drupal
    # Database environment variables will be provided by Quant Cloud
    # For local development, use docker-compose.override.yml

  mysql:
    image: mysql:8.4
    volumes:
      - mysql_data:/var/lib/mysql
    labels:
      quant.type: mysql
    # Database configuration in docker-compose.override.yml

  redis:
    image: redis:alpine
    labels:
      quant.type: none  # Don't deploy to Quant Cloud

volumes:
  drupal_cms:
    labels:
      quant.volume.type: efs  # Use EFS for shared persistent storage in Quant Cloud
  mysql_data:
